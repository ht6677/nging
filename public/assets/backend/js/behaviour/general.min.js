var App=function(){var a={tooltip:true,popover:true,nanoScroller:true,nestableLists:true,hiddenElements:true,bootstrapSwitch:true,dateTime:true,select2:true,tags:true,slider:true};var t=function(){$(".wizard-ux").wizard();$(".wizard-ux").on("changed",function(){$(".bslider").slider()});$(".wizard-next").click(function(t){$(".wizard-ux").wizard("next");t.preventDefault()});$(".wizard-previous").click(function(t){$(".wizard-ux").wizard("previous");t.preventDefault()})};function r(t){var e=$("#sidebar-collapse")[0];var a=$("#cl-wrapper");if(a.hasClass("sb-collapsed")){$(".fa",e).addClass("fa-angle-left").removeClass("fa-angle-right");a.removeClass("sb-collapsed")}else{$(".fa",e).removeClass("fa-angle-left").addClass("fa-angle-right");a.addClass("sb-collapsed")}}function e(){var n=window.location.pathname.replace(/^\//,"").replace(/[^\w]/g,"-");$(".page-aside").each(function(t){var e=$(this).attr("page-key")||n;var a=$(this),i=e+".page-aside-"+t;$(this).find(".header > .collapse-button").on("click",function(){a.addClass("collapsed");store.set(i,"collapsed");a.trigger("collapsed");f()});$(this).children(".collapsed-button").on("click",function(){a.removeClass("collapsed");store.set(i,"");a.trigger("expanded");f()});if(store.get(i)=="collapsed"){$(this).find(".header > .collapse-button").trigger("click")}})}function n(){var t=$("#main-container > .page-aside");var e=t.width();if(e<270){t.find(".header > .collapse-button").trigger("click");return}f()}function o(t){var e=t.children();if(e.length<1)return null;switch(e[0].tagName.toUpperCase()){case"TABLE":return e;default:return o(e)}}function f(t){if(t==null)t="#cl-wrapper > .cl-body .table-responsive";var e=t instanceof jQuery?t:$(t);var n=$("#pcont").offset().left,r=$(window).width()-n;e.each(function(){var t=$(this).offset().left-n;var e=r-t*2;var a=$(this).data("width");if(a&&a==e)return;$(this).data("width",e);var i=o($(this));if(i==null)return;if(i.outerWidth()>e){$(this).addClass("overflow").css("max-width",e)}else{$(this).removeClass("overflow").css("max-width",e)}})}var s=$("<div id='sub-menu-nav' style='position:fixed;z-index:9999;'></div>");function l(t,e){if(($("#cl-wrapper").hasClass("sb-collapsed")||$(window).width()>755&&$(window).width()<963)&&$("ul",t).length>0){$(t).removeClass("ocult");var a=$("ul",t);if(!$(".dropdown-header",t).length){var i='<li class="dropdown-header">'+$(t).children().html()+"</li>";a.prepend(i)}s.appendTo("body");var n=$(t).offset().top+8-$(window).scrollTop();var r=$(t).width();s.css({top:n,left:r+8});s.html('<ul class="sub-menu">'+a.html()+"</ul>");s.show();a.css("top",n)}else{s.hide()}}function c(){var t=220;var e=500;var a=$('<a href="#" class="back-to-top"><i class="fa fa-angle-up"></i></a>');a.appendTo("body");$(window).on("scroll",function(){if($(this).scrollTop()>t){$(".back-to-top").fadeIn(e)}else{$(".back-to-top").fadeOut(e)}});$(".back-to-top").on("click",function(t){t.preventDefault();$("html, body").animate({scrollTop:0},e);return false})}var d=null;return{clientID:{},i18n:{SYS_INFO:"System Information",UPLOAD_ERR:"Upload Error",PLEASE_SELECT_FOR_OPERATE:"Please select the item you want to operate",PLEASE_SELECT_FOR_REMOVE:"Please select the item you want to delete",CONFIRM_REMOVE:"Are you sure you want to delete them?",SELECTED_ITEMS:"You have selected %d items",SUCCESS:"The operation was successful",FAILURE:"Operation failed",UPLOADING:"File uploading, please wait...",UPLOAD_SUCCEED:"Upload successfully",BUTTON_UPLOAD:"Upload"},lang:"en",sprintf:sprintfWrapper.init,t:function(t){if(typeof App.i18n[t]=="undefined"){if(arguments.length<2)return t;return App.sprintf.apply(this,arguments)}if(arguments.length<2)return App.i18n[t];arguments[0]=App.i18n[t];return App.sprintf.apply(this,arguments)},langInfo:function(){if(d!=null)return d;var t=App.lang.split("-",2);d={encoding:t[0],country:""};if(t.length>1)d.country=t[1].toUpperCase();return d},langTag:function(t){var e=App.langInfo();if(e.country){if(t==null){t="-"}return e.encoding+t+e.country}return e.encoding},initTool:function(){s.hover(function(t){$(this).addClass("over")},function(){$(this).removeClass("over");s.fadeOut("fast")});$(document).click(function(){s.hide()});$(document).on("touchstart click",function(t){s.fadeOut("fast")});s.click(function(t){t.stopPropagation()})},initLeftNav:function(){$(".cl-vnavigation li ul").each(function(){$(this).parent().addClass("parent")});$(".cl-vnavigation li ul li.active").each(function(){$(this).parent().show().parent().addClass("open")});if(!$(".cl-vnavigation").data("initclick")){$(".cl-vnavigation").data("initclick",true);$(".cl-vnavigation").delegate(".parent > a","click",function(t){$(".cl-vnavigation .parent.open > ul").not($(this).parent().find("ul")).slideUp(300,"swing",function(){$(this).parent().removeClass("open")});var e=$(this).parent().find("ul");e.slideToggle(300,"swing",function(){var t=$(this).parent();if(t.hasClass("open")){t.removeClass("open")}else{t.addClass("open")}$("#cl-wrapper .nscroller").nanoScroller({preventPageScrolling:true})});t.preventDefault()})}$(".cl-vnavigation li").hover(function(t){l(this,t)},function(t){s.removeClass("over");setTimeout(function(){if(!s.hasClass("over")&&!$(".cl-vnavigation li:hover").length>0){s.hide()}},500)});$(".cl-vnavigation li").click(function(t){if(($("#cl-wrapper").hasClass("sb-collapsed")||$(window).width()>755&&$(window).width()<963)&&$("ul",this).length>0&&!($(window).width()<755)){l(this,t);t.stopPropagation()}})},initLeftNavAjax:function(t,e){App.markNavByURL(t);App.attachPjax(e,{onclick:function(t){if($(t).data("marknav")){App.unmarkNav($(t),$(t).data("marknav"));App.markNav($(t),$(t).data("marknav"))}},onend:function(t,e,a){a.container.find('[data-popover="popover"]').popover();a.container.find('.ttip, [data-toggle="tooltip"]').tooltip()}});App.attachAjaxURL(e)},init:function(t){$.extend(a,t);App.initLeftNav();App.initTool();App.showRequriedInputStar();$(".cl-toggle").click(function(t){var e=$(".cl-vnavigation");e.slideToggle(300,"swing",function(){});t.preventDefault()});$("#sidebar-collapse").click(function(){r()});if($("#cl-wrapper").hasClass("fixed-menu")){var n=$("#cl-wrapper .menu-space");n.addClass("nano nscroller");function e(){var t=$("#cl-wrapper .collapse-button");var e=t.outerHeight();var a=$("#head-nav").height();var i=$(window).height()-(t.is(":visible")?e:0)-a;n.css("height",i);$("#cl-wrapper .nscroller").nanoScroller({preventPageScrolling:true})}$(window).resize(function(){e()});e();$("#cl-wrapper .nscroller").nanoScroller({preventPageScrolling:true})}else{$(window).resize(function(){if($(window).width()>767){var t=$("#head-nav").height();$("#cl-wrapper").css("padding-top",t)}})}c();if($(".ui-datepicker").length>0)$(".ui-datepicker").datepicker();if(a.tooltip){$('.ttip, [data-toggle="tooltip"]').tooltip()}if(a.popover){$('[data-popover="popover"]').popover()}if(a.nanoScroller){$(".nscroller:not(.has-scrollbar)").nanoScroller()}if(a.nestableLists&&$(".dd").length>0){$(".dd").nestable()}if(a.bootstrapSwitch){if($(".switch:not(.has-switch)").length>0)$(".switch:not(.has-switch)").bootstrapSwitch()}if(a.dateTime){if($(".datetime").length>0)$(".datetime").datetimepicker({autoclose:true})}if(a.select2){if($(".select2").length>0)$(".select2").select2({width:"100%"})}if(a.tags){if($(".tags").length>0)$(".tags").select2({tags:0,width:"100%"})}if(a.slider){if($(".bslider").length>0)$(".bslider").slider()}if(a.hiddenElements){$(".dropdown").on("shown.bs.dropdown",function(){$(".nscroller").nanoScroller()});$(".nav-tabs").on("shown.bs.tab",function(t){$(".nscroller").nanoScroller()})}App.autoFixedThead();$(window).trigger("scroll")},autoFixedThead:function(t){if(t==null)t="";App.topFloatThead(t+"thead.auto-fixed",$("#head-nav").height())},pageAside:function(t){e(t)},tableReponsiveInit:function(t){n(t)},tableReponsive:function(t){f(t)},toggleSideBar:function(){r()},wizard:function(){t()},markNavByURL:function(t){if(!t)t=window.location.pathname;var e=$('#leftnav a[href="'+BACKEND_URL+t+'"]');if(e.length<1)e=$('#leftnav a[href="'+t+'"]');App.markNav(e,"left");var a=$('#topnav a[href="'+BACKEND_URL+t+'"]:first');if(a.length<1)a=$('#topnav a[href="'+t+'"]:first');App.markNav(a,"top")},markNav:function(t,e){if(t.length<1)return;var a=t.parent("li").addClass("active");switch(e){case"left":a.parent(".from-left").show().parent("li").addClass("open");var i=$("#leftnav").attr("data-project");var n=$('#topnav li[data-project="'+i+'"]');if(n.length>0&&!n.hasClass("active")){n.addClass("active").siblings(".active").removeClass("active").find(".active").removeClass("active")}break;case"top":a.parent(".from-top").parent("li").addClass("active").siblings("li.active").removeClass("active");break}},unmarkNav:function(t,e){var a=t.parent("li");var i=a.siblings("li.active");if(i.length>0){i.removeClass("active");return}switch(e){case"left":if(a.parent("ul.sub-menu").length>0){var n=$(".col-menu-2").children("li.open");if(n.length>0)n.removeClass("open").find("li.active").removeClass("active")}$("#leftnav > .open").removeClass("open").children("ul.sub-menu").hide().children("li.active").removeClass("active");$("#leftnav .active").removeClass("active");break;case"top":var r=a.parent("ul.dropdown-menu.from-top");if(r.length>0){i=r.parent("li").addClass("active").siblings("li.active")}if(i.length>0){i.removeClass("active").children("ul.dropdown-menu.from-top").children("li.active").removeClass("active")}break}},message:function(t,e){var a={title:App.i18n.SYS_INFO,text:"",image:"",class_name:"clean",sticky:false};if(typeof t!="object")t={text:t};if(typeof t.type!="undefined"&&t.type)t.class_name=t.type;t=$.extend({},a,t||{});switch(t.class_name){case"dark":case"primary":case"clean":case"info":if(t.title)t.title='<i class="fa fa-info-circle"></i> '+t.title;break;case"error":t.class_name="danger";case"danger":if(t.title)t.title='<i class="fa fa-comment-o"></i> '+t.title;break;case"warning":if(t.title)t.title='<i class="fa fa-warning"></i> '+t.title;break;case"success":if(t.title)t.title='<i class="fa fa-check"></i> '+t.title;break}if(e!=null)t.sticky=e;var i=$.gritter.add(t);return i},attachAjaxURL:function(t){if(t==null)t=document;$(t).on("click","[data-ajax-url]",function(){var a=$(this),t=a.data("ajax-url"),e=a.data("ajax-method")||"get",i=a.data("ajax-params")||{},n=a.attr("title"),r=a.data("ajax-accept")||"html",o=a.data("ajax-target"),s=a.data("ajax-callback");if(!n)n=a.text();if(o)App.loading("show");if($.isFunction(i))i=i.call(this,arguments);$[e](t,i||{},function(t){if(s)return s.call(this,arguments);if(o){var e;if(r=="json"){if(t.Code!=1){return App.message({title:n,text:t.Info,type:"error",time:5e3,sticky:false})}e=t.Data}else{e=t}$(o).html(e);a.trigger("partial.loaded",arguments);$(o).trigger("partial.loaded",arguments);App.loading("hide");return}if(r=="json"){return App.message({title:n,text:t.Info,type:t.Code==1?"success":"error",time:5e3,sticky:false})}App.message({title:n,text:t,time:5e3,sticky:false})},r)})},attachPjax:function(t,e,f){if(!$.support.pjax)return;if(t==null)t="a";if(f==null)f=5e3;var a={onclick:null,onsend:null,oncomplete:null,ontimeout:null,onstart:null,onend:null};var d=$.extend({},a,e||{});$(document).on("click",t+"[data-pjax]",function(t){var e=$(this).data("pjax"),a=$(this).data("keepjs");var i=$(this).data("onclick"),n=$(this).data("toggleclass");$.pjax.click(t,$(e),{timeout:f,keepjs:a});if(d.onclick)d.onclick(this);if(i&&typeof window[i]=="function")window[i](this);if(n){var r=n.split(":"),o,s;if(r.length>1){o=r[0];n=r[1]}n=n.replace(/^\./g,"");if(o){var l=o.indexOf("."),c;if(l>0){c=o.substring(l+1);o=o.substring(0,l)}switch(o){case"parent":s=$(this).parent(c);break;case"parents":s=$(this).parents(c);break;case"closest":s=$(this).closest(c);break;default:s=$(this).parent(c);break}}else{s=$(this)}s.addClass(n).siblings("."+n).removeClass(n)}$(".sp_result_area").remove();$(".tox").remove();$(".select2-hidden-accessible").remove();$(".select2-sizer").remove();$(".select2-drop").remove();$("#select2-drop-mask").remove()}).on("pjax:send",function(t,e,a){App.loading("show");if(d.onsend)d.onsend(t,e,a)}).on("pjax:complete",function(t,e,a,i){App.loading("hide");if(d.oncomplete)d.oncomplete(t,e,a,i)}).on("pjax:timeout",function(t,e,a){console.log("timeout");App.loading("hide");if(d.ontimeout)d.ontimeout(t,e,a)}).on("pjax:start",function(t,e,a){if(d.onstart)d.onstart(t,e,a)}).on("pjax:end",function(t,e,a){App.loading("hide");if(d.onend)d.onend(t,e,a);var i=a.container.attr("id");if(i){App.bottomFloat("#"+i+" .pagination");App.bottomFloat("#"+i+" .form-submit-group",0,true);$("#"+i+" .switch:not(.has-switch)").bootstrapSwitch();App.autoFixedThead("#"+i+" ")}if(a.type=="GET")$("#global-search-form").attr("action",a.url)})},wsURL:function(t){var e="ws:";if(window.location.protocol=="https:")e="wss:";var a=String(t).indexOf("//");if(a==-1){t=e+"//"+window.location.host+t}else{t=e+String(t).substring(a)}return t},websocket:function(e,t,a){t=App.wsURL(t);var i=new WebSocket(t);i.onopen=function(t){console.log("Websocket Server is connected");if(a!=null&&$.isFunction(a))a.apply(this,arguments)};i.onclose=function(t){console.log("Websocket Server is disconnected")};i.onmessage=function(t){e(t.data)};i.onerror=function(t){console.dir(t)};if(a!=null&&typeof a=="object"){i=$.extend({},i,a)}return i},notifyListen:function(){var l={notify:0,element:0,modal:0},c={notify:20,element:50,modal:50};App.websocket(function(t){var e=$.parseJSON(t);if(!e){App.message({text:t||"Websocket Server is disconnected",type:"error"});return false}if(typeof App.clientID["notify"]=="undefined"){App.clientID["notify"]=e.client_id}if(typeof e.content=="undefined"||!e.content){return false}switch(e.mode){case"-":break;case"element":var a=$("#notify-element-"+e.type);if(a.length<1){var i="recv_notice_"+e.type;if(typeof window[i]!="undefined"){return window[i](e)}if(e.status>0){console.info(e.content)}else{console.error(e.content)}return false}if(l[e.mode]>=c[e.mode]){a.find("li:first").remove()}if(e.title){var n="badge-danger";if(e.status>0)n="badge-success";t='<span class="badge '+n+'">'+App.text2html(e.title)+"</span> "+App.text2html(e.content)}else{t=App.text2html(e.content)}a.append("<li>"+t+"</li>");l[e.mode]++;break;case"modal":var a=$("#notify-modal-"+e.type);if(a.length<1){var i="recv_notice_"+e.type;if(typeof window[i]!="undefined"){return window[i](e)}if(e.status>0){console.info(e.content)}else{console.error(e.content)}return false}if(e.title){var n="badge-danger";if(e.status>0)n="badge-success";t='<span class="badge '+n+'">'+App.text2html(e.title)+"</span> "+App.text2html(e.content)}else{t=App.text2html(e.content)}if(!a.data("shown")){l[e.mode]=0;a.data("shown",true);var r=a.find(".modal-body"),o=r.children("ul.modal-body-ul");if(o.length<1){r.html('<ul class="modal-body-ul" id="notify-modal-'+e.type+'-container"><li>'+t+"</li></ul>")}else{o.html("<li>"+t+"</li>")}a.niftyModal("show",{afterOpen:function(t){},afterClose:function(t){a.data("shown",false)}})}else{var s=$("#notify-modal-"+e.type+"-container");if(l[e.mode]>=c[e.mode]){s.find("li:first").remove()}s.append("<li>"+t+"</li>")}l[e.mode]++;break;case"notify":default:if("notify"!=e.mode)e.mode="notify";var a=$("#notice-message-container");if(a.length<1){App.message({title:App.i18n.SYS_INFO,text:'<ul id="notice-message-container" class="no-list-style" style="max-height:500px;overflow-y:auto;overflow-x:hidden"></ul>',sticky:true});a=$("#notice-message-container")}if(l[e.mode]>=c[e.mode]){a.find("li:first").remove()}if(e.title){var n="badge-danger";if(e.status>0)n="badge-success";t='<span class="badge '+n+'">'+App.text2html(e.title)+"</span>"+App.text2html(e.content)}else{t=App.text2html(e.content)}a.append("<li>"+t+"</li>");l[e.mode]++;break}return true},BACKEND_URL+"/user/notice")},text2html:function(t){return String(t).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />").replace(/  /g,"&nbsp; ").replace(/\t/g,"&nbsp; &nbsp; ")},ifTextNl2br:function(t){t=String(t);if(/<[^>]+>/.test(t))return t;return t.replace(/\n/g,"<br />").replace(/  /g,"&nbsp; ").replace(/\t/g,"&nbsp; &nbsp; ")},checkedAll:function(t,e){return $(e).not(":disabled").prop("checked",$(t).prop("checked"))},attachCheckedAll:function(t,e,a){$(t).on("ifChecked ifUnchecked click",function(){App.checkedAll(this,e);if(a)$(a).text($(e+":checked").length)})},alertBlock:function(t,e,a){switch(a){case"info":if(e==null)e="Info!";return'<div class="alert alert-info">\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>\t\t\t\t\t\t\t\t<i class="fa fa-info-circle sign"></i><strong>'+e+"</strong> "+t+"</div>";case"warn":if(e==null)e="Alert!";return'<div class="alert alert-warning">\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>\t\t\t\t\t\t\t\t<i class="fa fa-warning sign"></i><strong>'+e+"</strong> "+t+"</div>";case"error":if(e==null)e="Error!";return'<div class="alert alert-danger">\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>\t\t\t\t\t\t\t\t<i class="fa fa-times-circle sign"></i><strong>'+e+"</strong> "+t+"</div>";default:if(e==null)e="Success!";return'<div class="alert alert-success">\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>\t\t\t\t\t\t\t\t<i class="fa fa-check sign"></i><strong>'+e+"</strong> "+t+"</div>"}},alertBlockx:function(t,e,a){switch(a){case"info":if(e==null)e="Info!";return'<div class="alert alert-info alert-white rounded">\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>\t\t\t\t\t\t\t\t<div class="icon"><i class="fa fa-info-circle"></i></div>\t\t\t\t\t\t\t\t<strong>'+e+"</strong> "+t+"</div>";case"warn":if(e==null)e="Alert!";return'<div class="alert alert-warning alert-white rounded">\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>\t\t\t\t\t\t\t\t<div class="icon"><i class="fa fa-warning"></i></div>\t\t\t\t\t\t\t\t<strong>'+e+"</strong> "+t+"</div>";case"error":if(e==null)e="Error!";return'<div class="alert alert-danger alert-white rounded">\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>\t\t\t\t\t\t\t\t<div class="icon"><i class="fa fa-times-circle"></i></div>\t\t\t\t\t\t\t\t<strong>'+e+"</strong> "+t+"</div>";default:if(e==null)e="Success!";return'<div class="alert alert-success alert-white rounded">\t\t\t\t\t\t\t\t<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>\t\t\t\t\t\t\t\t<div class="icon"><i class="fa fa-check"></i></div>\t\t\t\t\t\t\t\t<strong>'+e+"</strong> "+t+"</div>"}},showDbLog:function(t,e){if(e==null)e=".block-flat:first";if(typeof t.length=="undefined")t=[t];for(var a=0;a<t.length;a++){var i=t[a];var n=i.Started;if(i.SQLs&&i.SQLs.length>0){for(var r=0;r<i.SQLs.length;r++)n+='<code class="wrap">'+i.SQLs[r]+"</code>"}else{n+='<code class="wrap">'+i.SQL+"</code>"}var o="success";if(i.Error){n+="("+i.Error+")";o="error"}else{n+="("+i.Elapsed+")"}$(e).before(App.alertBlockx(n,null,o))}},loading:function(t){var e=$("#loading-status");switch(t){case"show":if(e.length>0){e.show()}else{$("body").append('<div id="loading-status"><i class="fa fa-spinner fa-spin fa-3x"></i></div>')}break;case"hide":if(e.length>0){e.hide()}}},insertAtCursor:function(t,e,a,i){if(typeof TextAreaEditor!="undefined"){TextAreaEditor.setSelectText(t,e,a,i);return}if(document.selection){t.focus();sel=document.selection.createRange();sel.text=e;sel.select()}else if(t.selectionStart||t.selectionStart=="0"){var n=t.selectionStart;var r=t.selectionEnd;var o=t.scrollTop;t.value=t.value.substring(0,n)+e+t.value.substring(r,t.value.length);if(o>0)t.scrollTop=o;t.focus();t.selectionStart=n+e.length;t.selectionEnd=n+e.length}else{t.value+=e;t.focus()}},searchFS:function(t,n,r,o,s){if(n==null)n=10;if(o==null)o=BACKEND_URL+"/user/autocomplete_path";$(t).typeahead({hint:true,highlight:true,minLength:1},{source:function(t,e,a){var i={query:t,size:n,type:r};$.ajax({url:o,type:"get",data:s?s(i):i,dataType:"json",async:false,success:function(t){var a=[];if(!t.Data)return;$.each(t.Data,function(t,e){a.push(e)});e(a)}})},limit:n})},randomString:function(t){t=t||32;var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";var a=e.length;var n="";for(i=0;i<t;i++){n+=e.charAt(Math.floor(Math.random()*a))}return n},bottomFloat:function(t,r,o){if($(t).length<1)return;if(r==null)r=0;$(t).not("[disabled-fixed]").each(function(){$(this).attr("disabled-fixed","fixed");var e=this;var t=$(e).height()+r;var a=$(e).offset().top+t;var i=$(e).outerWidth(),n=$(e).outerHeight();if(!o)o=$(e).data("auto-width");if(o)$(e).css("width",i);$(window).on("scroll",function(){var t=$(this).scrollTop()+$(window).height();if(t>=a){if($(e).hasClass("always-bottom")){$(e).removeClass("always-bottom");$(e).next(".fixed-placeholder").hide()}return}if(!$(e).hasClass("always-bottom")){$(e).addClass("always-bottom");if($(e).next(".fixed-placeholder").length>0){$(e).next(".fixed-placeholder").show()}else{$(e).after('<div style="width:'+i+"px;height:"+n+'px" class="fixed-placeholder"></div>')}}})})},topFloat:function(t,r,o){if($(t).length<1)return;if(r==null)r=0;$(t).not("[disabled-fixed]").each(function(){$(this).attr("disabled-fixed","fixed");var e=this;var a=$(e).offset().top;var i=$(e).outerWidth(),n=$(e).outerHeight();if(!o)o=$(e).data("auto-width");if(o)$(e).css("width",i);$(window).on("scroll",function(){var t=$(this).scrollTop();if(t<=a){if($(e).hasClass("always-top")){$(e).removeClass("always-top");$(e).next(".fixed-placeholder").hide()}return}if(!$(e).hasClass("always-top")){$(e).addClass("always-top").css("top",r);if($(e).next(".fixed-placeholder").length>0){$(e).next(".fixed-placeholder").show()}else{$(e).after('<div style="width:'+i+"px;height:"+n+'px" class="fixed-placeholder"></div>')}}})})},topFloatRawThead:function(t,r){if($(t).length<1)return;if(r==null)r=0;$(t).not("[disabled-fixed]").each(function(){$(this).attr("disabled-fixed","fixed");var o=this,s=$(o).parent("table"),l=s.parents(".table-responsive");var c=l.length>0;var a=$(o).offset().top,i=s.height()+a-$(o).outerHeight()*2;$(o).css({"background-color":"white"});var n=function(t){if(t==null)t=false;if(c){f(l);if(!l.hasClass("overflow")){$(o).css({width:"auto","overflow-x":"unset"})}}var e=$(o).outerWidth(),i=1;if(!t){if(Math.abs(s.data("width")-e)>1){i=e/s.data("width")}if(s.data("offset-left")!=$(s).offset().left){}else if(s.data("scroll-left")!=$(window).scrollLeft()){$(o).css({left:s.offset().left-$(window).scrollLeft()});if(i==1)return}}s.data("width",e);s.data("offset-left",$(s).offset().left);s.data("scroll-left",$(window).scrollLeft());var n=s.children("col"),a=$(o).find("td,th");if(n.length<1){var r="";a.each(function(){var t=$(this).outerWidth()*i;r+='<col style="min-width:'+t+'px;max-width:auto" />';$(this).css({"min-width":t,"max-width":"auto"})});s.prepend(r);return}a.each(function(t){var e=n.eq(t);var a=$(this).outerWidth()*i;e.css({width:a});$(this).css({width:a})})};n(true);$(window).on("scroll resize",function(){n();var t=$(this).scrollTop();if(t<=a||t>=i){if($(o).hasClass("always-top")){$(o).removeClass("always-top")}if(c){$(o).off("scroll").data("scroll-reponsive",false);l.off("scroll").data("scroll-thead",false)}return}if(s.height()>$(window).height()){if(!$(o).hasClass("always-top"))$(o).addClass("always-top");var e={top:r};if(c){e["width"]=l.outerWidth();if(l.hasClass("overflow"))e["overflow-x"]="auto";if(!$(o).data("scroll-reponsive")){$(o).on("scroll",function(){l.scrollLeft($(this).scrollLeft())}).data("scroll-reponsive",true)}if(!l.data("scroll-thead")){l.on("scroll",function(){$(o).scrollLeft($(this).scrollLeft())}).data("scroll-thead",true)}}$(o).css(e)}})});$(window).trigger("scroll")},topFloatThead:function(t,c,e){if(!e)return App.topFloatRawThead(t,c);if($(t).length<1)return;if(c==null)c=0;$(t).not("[disabled-fixed]").each(function(){$(this).attr("disabled-fixed","fixed");var i=this,t=$(i).parent("table");var e=$(i).offset().top,a=t.height()+e-$(i).outerHeight()*2,n=$(i).data("copy");if(n){$("#tableCopy"+n).remove()}else{n=Math.random();$(i).data("copy",n)}var s=$('<table class="'+t.attr("class")+' always-top" style="background-color:white" id="tableCopy'+n+'"></table>');var l=$(i).clone();s.append(l);var r=function(n){if(n==null)n=false;if(!n){if(s.data("offset-left")!=$(i).offset().left){}else if(s.data("scroll-left")!=$(window).scrollLeft()){s.css({left:$(i).offset().left-$(window).scrollLeft()});return}else{return}}s.data("offset-left",$(i).offset().left);s.data("scroll-left",$(window).scrollLeft());var r=l.find("td,th"),o=$(i).find("td,th");o.each(function(t){var e=r.eq(t);e.css("width",$(this).outerWidth());if(!n)return;var a=e.find("input:checkbox");if(a.length<1)return;var i=o.find("input:checkbox");a.each(function(t){i.eq(t).on("click change",function(){a.prop("checked",$(this).prop("checked"))})})});var t=$(i).offset().left-$(window).scrollLeft();var e=$(i).outerWidth(),a=$(i).outerHeight();s.css({top:c,left:t,width:e,height:a})};r(true);s.hide();t.after(s);$(window).on("scroll",function(){r();var t=$(this).scrollTop();if(t<=e||t>=a)return s.hide();s.show()})})},getImgNaturalDimensions:function(t,e){if(!t.naturalWidth){e({w:t.naturalWidth,h:t.naturalHeight});return}var a=new Image;a.onload=function(){e({w:a.width,h:a.height})};a.src=t.src},reportBug:function(t){$.post(t,{panic:$("#panic-content").html(),url:window.location.href},function(t){},"json")},replaceURLParam:function(t,e,a){if(a==null)a=window.location.href;e=encodeURIComponent(e);var i=String(a).indexOf("?");if(i<0)return a+"?"+t+"="+e;var n=a.substring(i),r=new RegExp("([\\?&]"+t+"=)[^&]*(&|$)");if(!r.test(n))return a+"&"+t+"="+e;a=a.substring(0,i);n=n.replace(r,"$1"+e+"$2");return a+n},switchLang:function(t){window.location=App.replaceURLParam("lang",t)},extends:function(t,e){var a=function(){};a.prototype=e.prototype;t.prototype=new a;t.prototype.constructor=t},formatBytes:function(t,e){if(e==null)e=2;var a=["YB","ZB","EB","PB","TB","GB","MB","KB","B"];var i=a.length;for(i--;i>0&&t>1024;i--){t/=1024}return t.toFixed(e)+a[i]},format:function(t,e,a){if(a&&typeof a[e.y]=="function")return a[e.y](t,e.x);return t},genTable:function(t,e){var a='<table class="table table-bordered no-margin">';var i="<thead>",n="<tbody>";for(var r=0;r<t.length;r++){var o=t[r];if(r==0){for(var s in o)i+='<th class="'+s+'"><strong>'+s+"</strong></th>"}n+="<tr>";for(var s in o)n+='<td class="'+s+'">'+App.format(o[s],{x:r,y:s},e)+"</td>";n+="</tr>"}i+="</thead>";n+="</tbody>";a+=i+n+"</table>";return a},httpStatusColor:function(t){if(t>=500)return"danger";if(t>=400)return"warning";if(t>=300)return"info";return"success"},logShow:function(t,e,i){if(!$("#log-show-modal").data("init")){$("#log-show-modal").data("init",true);$(window).off().on("resize",function(){$("#log-show-modal").css({height:$(window).height(),width:"100%","max-width":"100%",left:0,top:0,transform:"none"});$("#log-show-modal").find(".md-content").css("height",$(window).height());$("#log-show-content").css("height",$(window).height()-200)});$("#log-show-last-lines").on("change",function(t){var e=$(this).data("target");if(!e)return;var a=$(this).val();e.data("last-lines",a);e.trigger("click")});$("#log-show-modal .modal-footer .btn-refresh").on("click",function(t){var e=$("#log-show-last-lines").data("target");if(!e)return;e.trigger("click")});$(window).trigger("resize")}if(i==null)i="";var a=function(t){var e=$(t).data("url");var a=$(t).data("last-lines");if(a==null)a=100;$("#log-show-last-lines").data("target",$(t));var n="log-show-content",r="#"+n;$("#log-show-modal").niftyModal("show",{afterOpen:function(t){$.get(e,{lastLines:a,pipe:i},function(t){if(t.Code==1){var e=$("#log-show-modal .modal-header .modal-subtitle");if(typeof t.Data.title!="undefined"){if(t.Data.title)t.Data.title=" ("+t.Data.title+")";e.html(t.Data.title)}else{e.empty()}if(typeof t.Data.list!="undefined"){var a='<div class="table-responsive" id="'+n+'">'+App.genTable(t.Data.list,{StatusCode:function(t,e){return'<span class="label label-'+App.httpStatusColor(t)+'">'+t+"</span>"}})+"</div>";$(r).parent(".modal-body").css("padding",0);$(r).replaceWith(a)}else{if($(r)[0].tagName.toUpperCase()!="TEXTAREA"){$(r).replaceWith("<textarea name='content' class='form-control' id='"+n+"'></textarea>")}$(r).text(t.Data.content)}$(window).trigger("resize");var i=$(r)[0];i.scrollTop=i.scrollHeight}else{$(r).text(t.Info)}},"json")},afterClose:function(t){}})};if(e)return a(t);$(t).on("click",function(){a(this)})},tableSorting:function(t){t=t==null?"":t+" ";function c(t,e){var a,i,n;if(!e){a="fa-arrow-up";n="up";i="fa-arrow-down"}else{a="fa-arrow-down";n="down";i="fa-arrow-up"}if(t.length>0){var r=t.children(".fa");if(r.length<1){t.append('<i class="fa '+a+'"></i>')}else{r.removeClass(i).addClass(a)}t.addClass("sort-active sort-"+n);t.siblings(".sort-active").removeClass("sort-active").removeClass("sort-up").removeClass("sort-down").find(".fa").remove()}}$(t+'[sort-current!=""]').each(function(){var t=String($(this).attr("sort-current"));var e=t.substring(0,1)=="-";if(e)t=t.substring(1);var a=$(this).find('[sort="'+t+'"]');if(a.length<1&&t){a=$(this).find('[sort="-'+t+'"]')}c(a,e)});$(t+"[sort-current] [sort]").css("cursor","pointer").on("click",function(t){var e=$(this).parents("[sort-current]");var a=e.attr("sort-current");var i=e.attr("sort-url")||window.location.href;var n=e.attr("sort-trigger")||e.data("sort-trigger");var r=$(this).attr("sort");if(a&&(a==r||a=="-"+r)){var o=/^\-/;a=o.test(a)?a.replace(o,""):"-"+a}else{a=r}e.attr("sort-current",a);i=App.replaceURLParam("sort",a,i);if(n){e.data("sort-url",i);var s=a.substring(0,1)=="-";c($(this),s);window.setTimeout(n,0)}else{var l=e.attr("sort-setto");if(l){$(l).load(i)}else{window.location=i}}})},resizeModalHeight:function(t){var e=$(window).height()-200;if(e<200)e=200;var a=e-150;$(t).css({"max-height":e+"px"});$(t).find(".modal-body").css({"max-height":a+"px"})},switchStatus:function(e,a,t,i){if(a==null)a=$(e).data("type");if(t==null)t=$(e).data("url");var n=$(e),r=n.attr("data-"+a)=="Y"?"N":"Y",o={id:n.data("id")};var s=n.val();o[a]=r;if(String(t).charAt(0)!="/")t=BACKEND_URL+"/"+t;$.get(t,o,function(t){if(t.Code==1){n.attr("data-"+a,r);n.prop("checked",r==s)}App.message({title:App.i18n.SYS_INFO,text:t.Info,time:5e3,sticky:false,class_name:t.Code==1?"success":"error"});if(i)i.call(e,t)},"json")},bindSwitch:function(t,e,a,i,n){if(e==null)e="click";var r=new RegExp("switch-([\\w\\d]+)");$(t).on(e,function(){if(i==null){var t=String($(this).attr("class")).match(r);i=t[1]}App.switchStatus(this,i,a,n)})},removeSelected:function(t,e,a,i){return App.opSelected(t,e,a,i,App.i18n.CONFIRM_REMOVE,App.i18n.PLEASE_SELECT_FOR_REMOVE)},opSelected:function(t,e,a,i,n,r){if(a==null){a=window.location.href}else if(String(a).charAt(0)!="/"){a=BACKEND_URL+"/"+a}if(e==null)e="id";var o=[];$(t).each(function(){if($(this).is(":checked")&&!$(this).prop("disabled"))o.push({name:e,value:$(this).val()})});if(o.length<1){App.message({title:App.i18n.SYS_INFO,text:r||App.i18n.PLEASE_SELECT_FOR_OPERATE,type:"warning"});return false}var s=n;if(s){s+="\n"+App.sprintf(App.i18n.SELECTED_ITEMS,o.length);if(!confirm(s))return false}App.loading("show");$.get(a,o,function(t){App.loading("hide");if(i&&$.isFunction(i))return i();var e={title:App.i18n.SYS_INFO,text:t.Info,type:""};if(t.Code==1){e.type="success";if(!e.text)e.text="操作成功"}else{e.type="error";if(!e.text)e.text="操作失败"}App.message(e);window.setTimeout(function(){window.location.reload()},2e3)},"json");return true},parseBool:function(t){switch(String(t).toLowerCase()){case"0":case"false":case"n":case"no":case"off":case"null":return false;default:return true}},progressMonitor:function(e,a){NProgress.start();var i=window.setInterval(function(){var t=e()/a;if(t>=1){NProgress.set(1);window.clearInterval(i)}else{NProgress.set(t)}},50)},float:function(t,e,a,i,n){if(!e)e="ajax";if(!a)a=e=="remind"?"rel":"src";if(!i)i="5-7";else{switch(i){case"bottom":i="5-7";break;case"right":i="8-6";break;case"top":i="7-5";break;case"left":i="6-8";break;case"left-bottom":i="2-4";break;case"right-bottom":i="1-3";break;case"left-top":i="3-1";break;case"right-top":i="4-2";break}}var r={targetMode:e,targetAttr:a,position:i};$(t).powerFloat($.extend(r,n||{}))},uploadPreviewer:function(t,e,a){if($(t).parent(".file-preview-shadow").length<1){var i={buttonText:'<i class="fa fa-cloud-upload"></i> '+App.i18n.BUTTON_UPLOAD,previewTableContainer:"#previewTableContainer",url:"",previewTableShow:false,uploadProgress:function(t){var e=t*100;if(e>100){$.LoadingOverlay("hide");return}$.LoadingOverlay("progress",e)}};var n=$.extend({},i,e||{});var r=$(t).uploadPreviewer(n);$(t).data("uploadPreviewer",r);$(t).on("file-preview:changed",function(t){var e={image:ASSETS_URL+"/images/nging-gear.png",text:App.i18n.UPLOADING};if(n.uploadProgress){e.progress=true;e.image=""}$.LoadingOverlay("show",e);r.submit(function(t){$.LoadingOverlay("hide");if(t.Code==1){App.message({text:App.i18n.UPLOAD_SUCCEED,type:"success"})}else{App.message({text:t.Info,type:"error"})}if(a!=null)a.call(this,t)})})}},showRequriedInputStar:function(){$("form:not([required-redstar])").each(function(){$(this).find("[required]").each(function(){var t=$(this).parent(".input-group");if(t.length>0){t.addClass("required");return}t=$(this).parent('div[class*="col-"]');if(t.length>0&&t.prev(".control-label").length>0){t.prev(".control-label").addClass("required");return}var e=$(this).closest(".form-group");if(e.length<1)return;var a=e.children(".control-label:not(.required)");if(a.length<1)return;a.addClass("required")});$(this).attr("required-redstar","1")})},pushState:function(t,e,a){if(!window.history||!window.history.pushState)return;window.history.pushState(t,e,a)},replaceState:function(t,e,a){if(!window.history||!window.history.replaceState)return;window.history.replaceState(t,e,a)},formatJSON:function(t){t=$.trim(t);var e=t.substring(0,1);if(e=="["||e=="{"){var a=JSON.parse(t);t=JSON.stringify(a,null,"\t");return t}return""},formatJSONFromInnerHTML:function(t){if(t.data("jsonformatted"))return;t.data("jsonformatted",true);var e=App.formatJSON(t.html());if(e!="")t.html(e)}}}();$(function(){$("body").css({opacity:1,"margin-left":0})});